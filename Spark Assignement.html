<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Spark Assignement</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
    margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: rgba(35, 131, 226, .07); }
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-translucentGray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="0b8e1d37-f445-4e67-906f-2933794c5515" class="page sans"><header><h1 class="page-title">Spark Assignement</h1><p class="page-description"></p></header><div class="page-body"><hr id="22c5ad60-7b1f-49a9-a0e5-cd9b8f771d9d"/><details open=""><summary style="font-weight:600;font-size:1.5em;line-height:1.3;margin:0">Part 1</summary><div class="indented"><ul id="eaeb4e0e-d36b-4ed8-8d04-b9d6a349c9a2" class="toggle"><li><details open=""><summary>Solution</summary><ol type="1" id="11e34cd9-d6c3-4131-811d-68624403a0d9" class="numbered-list" start="1"><li><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="757d6d34-2e30-468e-8767-274ed0db298e" class="code code-wrap"><code class="language-Scala">class IntStack {
var Ilist : List[Int] = List();
  def enqueue(x:Int) ={
    Ilist = Ilist :+x 
  }
  def dequeue() : Int = {
    var x = Ilist.head
    Ilist = Ilist.tail 
    return x
  }
 def isEmpty() : Boolean= {
    if(Ilist.nonEmpty){
        false
}else{
true}
  }
}</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="9d4a0d77-acf2-4bd2-a1b2-065245ae4c2a" class="code"><code class="language-C#">scala&gt; class IntStack {
     | var Ilist : List[Int] = List();
     |   def enqueue(x:Int) ={
     |     Ilist = Ilist :+x 
     |   }
     |   def dequeue() : Int = {
     |     var x = Ilist.head
     |     Ilist = Ilist.tail 
     |     return x
     |   }
     |  def isEmpty() : Boolean= {
     |     if(Ilist.nonEmpty){
     |         false
     | }else{
     | true}
     |   }
     | }
defined class IntStack</code></pre></li></ol><ol type="1" id="e51cac5e-621a-41ff-b5df-80e1967d198c" class="numbered-list" start="2"><li><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="78980a68-9d2c-47ea-832b-5043c36a1b42" class="code code-wrap"><code class="language-Scala">class newStack  extends IntStack{
    override def toString():String = { 
         &quot;IntStack[&quot; + Ilist.toString + &quot;]&quot;
     }
}
var Stk = new newStack
Stk.enqueue(10)
Stk.enqueue(20)
Stk.dequeue()
Stk.isEmpty
print(Stk)</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="5be89ee5-656a-49cd-b6c2-d85a906bc724" class="code"><code class="language-C#">scala&gt; class newStack  extends IntStack{
     |     override def toString():String = { 
     |          &quot;IntStack[&quot; + Ilist.toString + &quot;]&quot;
     |      }
     | }
defined class newStack

scala&gt; var Stk = new newStack
Stk: newStack = IntStack[List()]

scala&gt; Stk.enqueue(10)

scala&gt; Stk.enqueue(20)

scala&gt; Stk.dequeue()
res2: Int = 10

scala&gt; Stk.isEmpty
res3: Boolean = false

scala&gt; print(Stk)
IntStack[List(20)]
scala&gt;</code></pre></li></ol><ol type="1" id="72c1570f-f7bf-411e-a2b1-9dd88078e81a" class="numbered-list" start="3"><li><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="e17034a0-c686-46a1-be3d-b5136f01da75" class="code code-wrap"><code class="language-Scala">def sort(list:List[Int]):List[Int]={
var s=list.toSet
var r=s.toList.reverse
r
}
var L = List(0,2,1,4,3)
println(sort(L))</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="7f5a53c7-845c-4198-b247-d52bd77bd854" class="code"><code class="language-C#">scala&gt; def sort(list:List[Int]):List[Int]={
     | var s=list.toSet
     | var r=s.toList.reverse
     | r
     | }
sort: (list: List[Int])List[Int]

scala&gt; var L = List(0,2,1,4,3)
L: List[Int] = List(0, 2, 1, 4, 3)

scala&gt; println(sort(L))
List(4, 3, 2, 1, 0)</code></pre></li></ol><ol type="1" id="960b1928-bf0b-47f5-bed4-5e1f7b1afd5b" class="numbered-list" start="4"><li><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1a2c7d8b-08e7-4e2c-b98d-2d0b47d6d7c6" class="code code-wrap"><code class="language-Scala">def sortUniqueWords(word: String): String = {
    var s = word.split(&quot;:&quot;).toSet
    var r = s.toList

    var str = &quot;&quot;
    for (i &lt;- 0 until r.length) {
        str += r(i) + &quot;,&quot;
    }
    str = str.dropRight(1)
    str
    }

    val str1 = &quot;apple:orange:banana:apple:grapes:orange&quot;
    val str2 = sortUniqueWords(str1)

    println(str2)</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="97abb1de-c3b2-456b-b407-8f4095bfb714" class="code"><code class="language-C#">scala&gt; def sortUniqueWords(word: String): String = {
     |     var s = word.split(&quot;:&quot;).toSet
     |     var r = s.toList
     | 
     |     var str = &quot;&quot;
     |     for (i &lt;- 0 until r.length) {
     |         str += r(i) + &quot;,&quot;
     |     }
     |     str = str.dropRight(1)
     |     str
     |     }
sortUniqueWords: (word: String)String

scala&gt; 

scala&gt;     val str1 = &quot;apple:orange:banana:apple:grapes:orange&quot;
str1: String = apple:orange:banana:apple:grapes:orange

scala&gt;     val str2 = sortUniqueWords(str1)
str2: String = apple,orange,banana,grapes

scala&gt; 

scala&gt;     println(str2)
apple,orange,banana,grapes</code></pre></li></ol><ol type="1" id="24da45c1-0d9a-411f-badf-49ee7b9804a0" class="numbered-list" start="5"><li><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="f34ceea2-f45a-41cf-9ee7-7f957e65ab9a" class="code code-wrap"><code class="language-Scala">def max_min(word: String): (Int, Int) = {
  val L= word.split(&quot;,&quot;).toList.map(_.toInt) 
  var max = L.head
  var min = L.head

  for (num &lt;- L.tail) {
    if (num &gt; max) {
      max = num
    }
    if (num &lt; min) {
      min = num
    }
  }

  (min, max) 
}

val inputString = &quot;3,7,2,9,5,1&quot;
val result = max_min(inputString)
println(result)</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="60f6a5e8-b93c-4ad7-806f-615584250315" class="code"><code class="language-C#">scala&gt; def max_min(word: String): (Int, Int) = {
     |   val L= word.split(&quot;,&quot;).toList.map(_.toInt) 
     |   var max = L.head
     |   var min = L.head
     | 
     |   for (num &lt;- L.tail) {
     |     if (num &gt; max) {
     |       max = num
     |     }
     |     if (num &lt; min) {
     |       min = num
     |     }
     |   }
     | 
     |   (min, max) 
     | }
max_min: (word: String)(Int, Int)

scala&gt; 

scala&gt; val inputString = &quot;3,7,2,9,5,1&quot;
inputString: String = 3,7,2,9,5,1

scala&gt; val result = max_min(inputString)
result: (Int, Int) = (1,9)

scala&gt; println(result)
(1,9)

scala&gt;</code></pre></li></ol><ol type="1" id="aebdabd0-ac24-4180-aee2-ce96b4a23868" class="numbered-list" start="6"><li><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="f48b31b1-dab5-460f-91e3-753121a7d808" class="code code-wrap"><code class="language-Scala">val arr: Array[Int] = (1 to 20 by 2).toArray
var summ = 0

for (n &lt;- 0 until 10) {
  summ += arr(n)
  println(&quot;sum of first &quot;+n +&quot; elements: &quot;+summ)
}</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="c011c434-fbe9-4f71-87ea-dc0f27e6ac85" class="code"><code class="language-C#">scala&gt; val arr: Array[Int] = (1 to 20 by 2).toArray
arr: Array[Int] = Array(1, 3, 5, 7, 9, 11, 13, 15, 17, 19)

scala&gt; var summ = 0
summ: Int = 0

scala&gt; 

scala&gt; for (n &lt;- 0 until 10) {
     |   summ += arr(n)
     |   println(&quot;sum of first &quot;+n +&quot; elements: &quot;+summ)
     | }
sum of first 0 elements: 1
sum of first 1 elements: 4
sum of first 2 elements: 9
sum of first 3 elements: 16
sum of first 4 elements: 25
sum of first 5 elements: 36
sum of first 6 elements: 49
sum of first 7 elements: 64
sum of first 8 elements: 81
sum of first 9 elements: 100

scala&gt;</code></pre></li></ol><ol type="1" id="11a695d0-69f9-4473-899a-9441d419b5ce" class="numbered-list" start="7"><li><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="b30fbf5f-a48d-4be9-9b0d-11bea125de22" class="code code-wrap"><code class="language-Scala">var max_min=(x:Int,y:Int)=&gt; if (x&gt;y){&quot;max=&quot;+x+&quot; min=&quot;+y}else{&quot;max=&quot;+y+&quot; min=&quot;+x}
var str=max_min(7,14)</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2041cea8-4fee-421b-ac1b-8c1f2feddff3" class="code"><code class="language-C#">scala&gt; var max_min=(x:Int,y:Int)=&gt; if (x&gt;y){&quot;max=&quot;+x+&quot; min=&quot;+y}else{&quot;max=&quot;+y+&quot; min=&quot;+x}
max_min: (Int, Int) =&gt; String = &lt;function2&gt;

scala&gt; var str=max_min(7,14)
str: String = max=14 min=7</code></pre></li></ol><ol type="1" id="f32aab48-f57f-4ef8-91fc-b8957186dab9" class="numbered-list" start="8"><li><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a20cbaf5-bf0f-4856-8815-1c59dfd49143" class="code code-wrap"><code class="language-Scala">val rand = scala.util.Random
var m: Map[Int, (Int, Int)] = Map()
for (i &lt;- 1 to 10) {
  m += (i -&gt; (rand.nextInt(100), rand.nextInt(100)))
}

def secval(inputMap: Map[Int, (Int, Int)], firstValue: Int): List[Int] = {
  var t = List[Int]()

  for (n &lt;- inputMap.keys) {
    if (inputMap(n)._1 == firstValue) {
      t = t :+ inputMap(n)._2
    } 
  }

  t
}

val nm= 23
val secondValuesList = secval(m, nm)
println(&quot;Second values : &quot;+secondValuesList)</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="4d985cb8-d96e-4fe9-8a72-a5b33863c135" class="code"><code class="language-C#">scala&gt; val rand = scala.util.Random
rand: util.Random.type = scala.util.Random$@79c26be5

scala&gt; var m: Map[Int, (Int, Int)] = Map()
m: Map[Int,(Int, Int)] = Map()

scala&gt; for (i &lt;- 1 to 10) {
     |   m += (i -&gt; (rand.nextInt(100), rand.nextInt(100)))
     | }

scala&gt; 

scala&gt; def secval(inputMap: Map[Int, (Int, Int)], firstValue: Int): List[Int] = {
     |   var t = List[Int]()
     | 
     |   for (n &lt;- inputMap.keys) {
     |     if (inputMap(n)._1 == firstValue) {
     |       t = t :+ inputMap(n)._2
     |     } 
     |   }
     | 
     |   t
     | }
secval: (inputMap: Map[Int,(Int, Int)], firstValue: Int)List[Int]

scala&gt; 

scala&gt; val nm= 23
nm: Int = 23

scala&gt; val secondValuesList = secval(m, nm)
secondValuesList: List[Int] = List()

scala&gt; println(&quot;Second values : &quot;+secondValuesList)
Second values : List()

scala&gt;</code></pre></li></ol><ol type="1" id="f4a18a65-0527-45dc-b4bf-06f7aaad0e00" class="numbered-list" start="9"><li><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3228367c-26d5-4172-8aba-30cb7e3c7744" class="code code-wrap"><code class="language-Scala">val rand = scala.util.Random
var m: Map[Int, (Int, Int)] = Map()
for (i &lt;- 1 to 100) {
  m += (i -&gt; (rand.nextInt(100), rand.nextInt(100)))
}
def somm(inputMap: Map[Int, (Int, Int)], passedInt: Int): Option[Int] = {
  inputMap.get(passedInt) match {
    case Some((value1, value2)) =&gt; Some(value1 + value2)
    case None =&gt; None
  }
}

val randomNumber = rand.nextInt(200)
val result = somm(m, randomNumber)
result match {
  case Some(sum) =&gt; println(&quot;Sum of tuple :&quot;+ sum)
  case None =&gt; println(&quot;None returned.&quot;)
}</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="5a0f7ad2-af50-4504-80ad-d5a15a35575a" class="code"><code class="language-C#">scala&gt; val rand = scala.util.Random
rand: util.Random.type = scala.util.Random$@79c26be5

scala&gt; var m: Map[Int, (Int, Int)] = Map()
m: Map[Int,(Int, Int)] = Map()

scala&gt; for (i &lt;- 1 to 100) {
     |   m += (i -&gt; (rand.nextInt(100), rand.nextInt(100)))
     | }

scala&gt; def somm(inputMap: Map[Int, (Int, Int)], passedInt: Int): Option[Int] = {
     |   inputMap.get(passedInt) match {
     |     case Some((value1, value2)) =&gt; Some(value1 + value2)
     |     case None =&gt; None
     |   }
     | }
somm: (inputMap: Map[Int,(Int, Int)], passedInt: Int)Option[Int]

scala&gt; 

scala&gt; val randomNumber = rand.nextInt(200)
randomNumber: Int = 83

scala&gt; val result = somm(m, randomNumber)
result: Option[Int] = Some(164)

scala&gt; result match {
     |   case Some(sum) =&gt; println(&quot;Sum of tuple :&quot;+ sum)
     |   case None =&gt; println(&quot;None returned.&quot;)
     | }
Sum of tuple :164</code></pre></li></ol><ol type="1" id="183b1906-09f6-441b-a78d-c8f8d04fd21e" class="numbered-list" start="10"><li><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="740ec134-59be-4dda-abc2-c079103c8619" class="code code-wrap"><code class="language-Scala">case class HospitalRecord(customerId: Int, visitDate: String, symptoms: String)
def hasSymptom(record: HospitalRecord, symptom: String): Boolean = {
  val L= record.symptoms.split(&quot;:&quot;).toList
  L.contains(symptom)
}</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a69881ac-de4e-4f7f-86e1-43cdce383aa4" class="code"><code class="language-C#">scala&gt; case class HospitalRecord(customerId: Int, visitDate: String, symptoms: String)
defined class HospitalRecord

scala&gt; def hasSymptom(record: HospitalRecord, symptom: String): Boolean = {
     |   val L= record.symptoms.split(&quot;:&quot;).toList
     |   L.contains(symptom)
     | }
hasSymptom: (record: HospitalRecord, symptom: String)Boolean

scala&gt;</code></pre></li></ol><ol type="1" id="aa9c1a60-8f75-49ab-beff-eb74fcdef15f" class="numbered-list" start="11"><li><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="328d262f-854d-478e-a7a0-0924e9283fc1" class="code code-wrap"><code class="language-Scala">case class PurchaseRecord(productName: String, purchasePrice: Double, purchaseDate: String)
val a = PurchaseRecord(&quot;ProductA&quot;, 49.99, &quot;2023-01-15&quot;)
val b = a.copy(productName = &quot;ProductB&quot;, purchasePrice = 29.99)
val c = b.copy(productName = &quot;ProductC&quot;, purchasePrice = 39.99)

def matchRecord(record: PurchaseRecord, pattern: String): Option[Double] = {
  if (record.productName.matches(pattern)) {
    Some(record.purchasePrice)
  } else {
    None
  }
}</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="25c792b1-6132-427b-b655-10bb2a00647a" class="code"><code class="language-C#">scala&gt; case class PurchaseRecord(productName: String, purchasePrice: Double, purchaseDate: String)
defined class PurchaseRecord

scala&gt; val a = PurchaseRecord(&quot;ProductA&quot;, 49.99, &quot;2023-01-15&quot;)
a: PurchaseRecord = PurchaseRecord(ProductA,49.99,2023-01-15)

scala&gt; val b = a.copy(productName = &quot;ProductB&quot;, purchasePrice = 29.99)
b: PurchaseRecord = PurchaseRecord(ProductB,29.99,2023-01-15)

scala&gt; val c = b.copy(productName = &quot;ProductC&quot;, purchasePrice = 39.99)
c: PurchaseRecord = PurchaseRecord(ProductC,39.99,2023-01-15)

scala&gt; 

scala&gt; def matchRecord(record: PurchaseRecord, pattern: String): Option[Double] = {
     |   if (record.productName.matches(pattern)) {
     |     Some(record.purchasePrice)
     |   } else {
     |     None
     |   }
     | }
matchRecord: (record: PurchaseRecord, pattern: String)Option[Double]

scala&gt;</code></pre></li></ol><ol type="1" id="69c56cab-bdd0-49be-a75f-684dc2ab9c95" class="numbered-list" start="12"><li><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="d9fd0589-8056-41a2-a63a-1d3899ba96d9" class="code code-wrap"><code class="language-Scala">:paste

class SalesRecord(val itemName: String, val saleDate: String, val numberOfItems: Int, val purchaseAmount: Double)

object SalesRecord {
  var itemsPurchased: Map[String, Int] = Map().withDefaultValue(0)

  def trackItemPurchase(itemName: String): Unit = {
    itemsPurchased += itemName -&gt; (itemsPurchased(itemName) + 1)
  }

  def getItemPurchaseCount(itemName: String): Int = {
    itemsPurchased(itemName)
  }
}

// Press Ctrl+D (or Cmd+D on macOS) to exit paste mode and execute the code</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a7f0a8d4-e739-4e67-834c-7b32d7410130" class="code"><code class="language-C#">defined class SalesRecord
defined object SalesRecord</code></pre></li></ol><ol type="1" id="b39e5263-0bba-4b17-9659-c641867106af" class="numbered-list" start="13"><li><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="0a5bdf5e-43d1-4f30-bf60-838ce6a04a43" class="code code-wrap"><code class="language-Scala">def filter(func: String =&gt; Boolean): Boolean = func(itemName)

val record = new SalesRecord(&quot;ExampleItem&quot;, &quot;2023-01-15&quot;, 2, 99.99)
val result = SalesRecord.filter(record, itemName =&gt; itemName.startsWith(&quot;Example&quot;))

println(result)</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="c2b39c7d-8a46-488c-b33a-ad1dd8624b43" class="code"><code class="language-C#">scala&gt; println(result)
Some(164)</code></pre></li></ol><ol type="1" id="c900b11f-b34d-42c3-b9fa-ac5a8df5a678" class="numbered-list" start="14"><li><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="6a8ceeda-82ed-451d-bc46-971587d95a99" class="code code-wrap"><code class="language-Scala">class IntStack {
  var Ilist: List[Int] = List()

  def push(element: Int): IntStack = {
    val newStack = new IntStack()
    newStack.Ilist = element :: Ilist
    newStack
  }

  def pop(): (Int, IntStack) = {
    if (Ilist.isEmpty)
      throw new NoSuchElementException(&quot;pop on empty stack&quot;)
    else
      (Ilist.head, new IntStack { Ilist = Ilist.tail })
  }

  // ... other methods for your IntStack class

  def map(func: Int =&gt; Int): IntStack = {
    val newStack = new IntStack()
    newStack.Ilist = this.Ilist.map(func)
    newStack
  }
}

// Example usage:
val stack = new IntStack().push(1).push(2).push(3)
val mappedStack = stack.map(_ * 2)

// Print the original and mapped stacks
println(&quot;Original Stack: &quot; + stack.Ilist)        // Output: Original Stack: List(3, 2, 1)
println(&quot;Mapped Stack: &quot; + mappedStack.Ilist)    // Output: Mapped Stack: List(6, 4, 2)</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="8f4bf0e4-0234-411b-b825-24175aab84c1" class="code"><code class="language-C#">scala&gt; // Example usage:

scala&gt; val stack = new IntStack().push(1).push(2).push(3)
stack: IntStack = IntStack@653856e6

scala&gt; val mappedStack = stack.map(_ * 2)
mappedStack: IntStack = IntStack@62cfcf31

scala&gt; 

scala&gt; // Print the original and mapped stacks

scala&gt; println(&quot;Original Stack: &quot; + stack.Ilist)        // Output: Original Stack: List(3, 2, 1)
Original Stack: List(3, 2, 1)

scala&gt; println(&quot;Mapped Stack: &quot; + mappedStack.Ilist)    // Output: Mapped Stack: List(6, 4, 2)
Mapped Stack: List(6, 4, 2)

scala&gt;</code></pre></li></ol><ol type="1" id="ee921d92-206f-4fe0-9cd9-e0ed275c7625" class="numbered-list" start="15"><li><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a4b825e8-9301-4989-a4f5-9963fabad033" class="code code-wrap"><code class="language-Scala">class IntStack {
  var Ilist: List[Int] = List()

  def push(element: Int): IntStack = {
    val newStack = new IntStack()
    newStack.Ilist = element :: Ilist
    newStack
  }

  def pop(): (Int, IntStack) = {
    if (Ilist.isEmpty)
      throw new NoSuchElementException(&quot;pop on empty stack&quot;)
    else
      (Ilist.head, new IntStack { Ilist = Ilist.tail })
  }

  // ... other methods for your IntStack class

  def map(func: Int =&gt; Int): IntStack = {
    val newStack = new IntStack()
    newStack.Ilist = this.Ilist.map(func)
    newStack
  }

  def filter(func: Int =&gt; Boolean): IntStack = {
    val newStack = new IntStack()
    newStack.Ilist = this.Ilist.filter(func)
    newStack
  }
}

// Example usage:
val stack = new IntStack().push(1).push(2).push(3)
val filteredStack = stack.filter(_ % 2 == 0)

// Print the original and filtered stacks
println(&quot;Original Stack: &quot; + stack.Ilist)            // Output: Original Stack: List(3, 2, 1)
println(&quot;Filtered Stack (even numbers): &quot; + filteredStack.Ilist)  // Output: Filtered Stack (even numbers): List(2)</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="31af13e0-3d59-43de-a2ae-5533667eb311" class="code"><code class="language-C#">scala&gt; // Example usage:

scala&gt; val stack = new IntStack().push(1).push(2).push(3)
stack: IntStack = IntStack@63941b57

scala&gt; val filteredStack = stack.filter(_ % 2 == 0)
filteredStack: IntStack = IntStack@32b40e0a

scala&gt; 

scala&gt; // Print the original and filtered stacks

scala&gt; println(&quot;Original Stack: &quot; + stack.Ilist)            // Output: Original Stack: List(3, 2, 1)
Original Stack: List(3, 2, 1)

scala&gt; println(&quot;Filtered Stack (even numbers): &quot; + filteredStack.Ilist)  // Output: Filtered Stack (even numbers): List(2)
Filtered Stack (even numbers): List(2)</code></pre></li></ol></details></li></ul></div></details><details open=""><summary style="font-weight:600;font-size:1.5em;line-height:1.3;margin:0">Part 2</summary><div class="indented"><ul id="c1c18544-c388-4f41-8494-0b4a86187663" class="toggle"><li><details open=""><summary>Datasets <code><strong>.csv</strong></code></summary><div id="b31aaa9b-78d1-4858-880e-c5c84e0f50c9" class="column-list"><div id="f9ca677e-489b-4708-a135-eba388f2b87d" style="width:50%" class="column"><p id="a03f5a3c-12b9-4499-9f12-5c0c1d4964aa" class="">file name: hospitalData</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="dbf08d6b-fb73-403c-a94b-21f43407c390" class="code code-wrap"><code class="language-Plain Text">Customer ID,Visit Date,Symptoms
1,2023-01-15,Fever:Headache:Cough
2,2023-02-28,Sore Throat:Fever:Fatigue
3,2023-03-10,Headache:Cough:Cold
4,2023-04-05,Fever:Runny Nose:Fatigue
5,2023-05-20,Cough:Headache:Sore Throat
6,2023-06-08,Runny Nose:Fatigue:Headache
7,2023-07-17,Fever:Sore Throat:Cough
8,2023-08-22,Headache:Fever:Fatigue
9,2023-09-30,Cold:Runny Nose:Cough
10,2023-10-12,Sore Throat:Fever:Fatigue
11,2023-11-25,Fever:Headache:Cough
12,2023-12-03,Runny Nose:Headache:Fatigue
13,2024-01-08,Fever:Runny Nose:Sore Throat
14,2024-02-14,Headache:Cough:Cold
15,2024-03-19,Fatigue:Fever:Runny Nose
16,2024-04-22,Sore Throat:Headache:Fatigue
17,2024-05-30,Fever:Runny Nose:Headache
18,2024-06-05,Cough:Headache:Fatigue
19,2024-07-18,Fever:Sore Throat:Runny Nose
20,2024-08-25,Headache:Cough:Fatigue</code></pre></div><div id="ff298b7b-9128-4fdd-b4c1-d0760e690a17" style="width:50%" class="column"><p id="cf79ea86-dff3-4c22-9072-b28fa5a5d39a" class="">file name: purchaseData</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="5fdbef0d-49cc-4a85-b209-b3c953d6eba4" class="code code-wrap"><code class="language-Bash">ProductName,PurchasePrice,PurchaseDate
ProductA,120,2023-01-15
ProductB,80,2023-02-28
ProductC,150,2023-03-10
ProductD,90,2023-04-05
ProductE,110,2023-05-20
ProductF,130,2023-06-08
ProductG,95,2023-07-17
ProductH,120,2023-08-22
ProductI,80,2023-09-30
ProductJ,150,2023-10-12
ProductK,110,2023-11-25
ProductL,130,2023-12-03
ProductM,95,2024-01-08
ProductN,120,2024-02-14
ProductO,80,2024-03-19
ProductP,150,2024-04-22
ProductQ,110,2024-05-30
ProductR,130,2024-06-05
ProductS,95,2024-07-18
ProductT,120,2024-08-25</code></pre></div></div><ul id="f01b2292-a502-4211-88f7-1a7e9303105b" class="bulleted-list"><li style="list-style-type:disc">path to dataset<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="52b47268-8301-4c04-9bb6-982f42c8f31e" class="code code-wrap"><code class="language-Bash"># path to datasets .csv
/home/dexter/Desktop/spark_assignements/Part2/hospitalData.csv
/home/dexter/Desktop/spark_assignements/Part2/purchaseData.csv

# load from local file system by this path
file:///home/dexter/Desktop/spark_assignements/Part2/hospitalData.csv
file:///home/dexter/Desktop/spark_assignements/Part2/purchaseData.csv

cd /home/dexter/Desktop/spark_assignements/Part2/

# create dir for data
hadoop fs -mkdir /spark

# copy the data to hdfs
hadoop fs -copyFromLocal hospitalData.csv /spark/hospitalData.csv
hadoop fs -copyFromLocal purchaseData.csv /spark/purchaseData.csv</code></pre></li></ul></details></li></ul><ul id="7aa6bedc-c822-40f6-b801-325fdc2e66ec" class="toggle"><li><details open=""><summary>Solution</summary><ul id="d429050a-8cc8-4338-b112-7e2838da883d" class="toggle"><li><details open=""><summary>7.1) Read the purchase record data as an RDD. Filter the records that have price &gt; 100 and print the RDD.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="7cb94926-a4be-4085-8f35-cd884c89d874" class="code code-wrap"><code class="language-Scala">import spark.implicits._

val df1 = spark.read.option(&quot;header&quot;, &quot;true&quot;).option(&quot;inferSchema&quot;, &quot;true&quot;).csv(&quot;/spark/purchaseData.csv&quot;)
df1.where(&quot;PurchasePrice &gt; 100&quot;).show()</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="6ab993bd-ae00-4729-9d16-f327f861f301" class="code code-wrap"><code class="language-Scala">scala&gt; df1.where(&quot;PurchasePrice &gt; 100&quot;).show()
+-----------+-------------+-------------------+
|ProductName|PurchasePrice|       PurchaseDate|
+-----------+-------------+-------------------+
|   ProductA|          120|2023-01-15 00:00:00|
|   ProductC|          150|2023-03-10 00:00:00|
|   ProductE|          110|2023-05-20 00:00:00|
|   ProductF|          130|2023-06-08 00:00:00|
|   ProductH|          120|2023-08-22 00:00:00|
|   ProductJ|          150|2023-10-12 00:00:00|
|   ProductK|          110|2023-11-25 00:00:00|
|   ProductL|          130|2023-12-03 00:00:00|
|   ProductN|          120|2024-02-14 00:00:00|
|   ProductP|          150|2024-04-22 00:00:00|
|   ProductQ|          110|2024-05-30 00:00:00|
|   ProductR|          130|2024-06-05 00:00:00|
|   ProductT|          120|2024-08-25 00:00:00|
+-----------+-------------+-------------------+</code></pre></details></li></ul><ul id="789e20e9-d671-4444-82f4-c8e2a458b985" class="toggle"><li><details open=""><summary>7.2) Read the hospital record as an RDD. Create another RDD by removing the duplicates from the symptoms. save this RDD as a file in HDFS.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="e64b84c0-72f9-401a-b40a-504d796b6354" class="code code-wrap"><code class="language-Scala">val dfs = spark.read.option(&quot;header&quot;, &quot;true&quot;).option(&quot;inferSchema&quot;, &quot;true&quot;).csv(&quot;/spark/hospitalData.csv&quot;)
val RDD = dfs.rdd
val symptomsRDD = RDD.map(row =&gt; row.getString(2)).distinct()
val symptomArray = symptomsRDD.take(10)
symptomArray.foreach(println)
symptomsRDD.saveAsTextFile(&quot;hdfs:///spark/output2.txt&quot;)</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="b282be56-2448-414d-8198-64d35944c7b4" class="code code-wrap"><code class="language-Scala">scala&gt; symptomArray.foreach(println)
Fever:Runny Nose:Headache
Cough:Headache:Sore Throat
Headache:Cough:Cold
Sore Throat:Fever:Fatigue
Cold:Runny Nose:Cough
Cough:Headache:Fatigue
Fever:Runny Nose:Fatigue
Fatigue:Fever:Runny Nose
Headache:Cough:Fatigue
Runny Nose:Fatigue:Headache

scala&gt; symptomsRDD.saveAsTextFile(&quot;hdfs:///spark/output2.txt&quot;)

scala&gt;</code></pre></details></li></ul><ul id="84c4a384-177a-4ebf-b774-e46aa7919ca1" class="toggle"><li><details open=""><summary>7.3) Read the purchase record as a dataframe. select only first two columns and show the results.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="6a6e74aa-4ca3-42e6-a18b-8c9f219138ea" class="code code-wrap"><code class="language-Scala">val df1=spark.read.option(&quot;header&quot;,&quot;true&quot;).option(&quot;inferSchema&quot;,&quot;true&quot;).csv(&quot;/spark/purchaseData.csv&quot;)
df1.select(&quot;ProductName&quot;, &quot;PurchasePrice&quot;).show()</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="bba1311f-e460-4776-a59c-58286969054e" class="code code-wrap"><code class="language-Scala">scala&gt; df1.select(&quot;ProductName&quot;, &quot;PurchasePrice&quot;).show()
+-----------+-------------+
|ProductName|PurchasePrice|
+-----------+-------------+
|   ProductA|          120|
|   ProductB|           80|
|   ProductC|          150|
|   ProductD|           90|
|   ProductE|          110|
|   ProductF|          130|
|   ProductG|           95|
|   ProductH|          120|
|   ProductI|           80|
|   ProductJ|          150|
|   ProductK|          110|
|   ProductL|          130|
|   ProductM|           95|
|   ProductN|          120|
|   ProductO|           80|
|   ProductP|          150|
|   ProductQ|          110|
|   ProductR|          130|
|   ProductS|           95|
|   ProductT|          120|
+-----------+-------------+</code></pre></details></li></ul><ul id="71c9832e-9825-4277-94c8-af39df9e0861" class="toggle"><li><details open=""><summary>7.4) Read the hospital record as a dataframe. write a query to find out the number of visits by each patient.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="e7e45459-f28a-418e-ba46-aa4c598a5fd4" class="code code-wrap"><code class="language-Scala">val dfs=spark.read.option(&quot;header&quot;,&quot;true&quot;).option(&quot;inferSchema&quot;,&quot;true&quot;).csv(&quot;/spark/hospitalData.csv&quot;)
dfs.createOrReplaceTempView(&quot;visite&quot;)
sql(&quot;SELECT `Customer ID` AS ID, COUNT(*) AS number_of_visits FROM visite GROUP BY `Customer ID`&quot;).show()</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="8d86b5d9-87cf-4d83-a716-9feb6167ab62" class="code code-wrap"><code class="language-Scala">scala&gt; sql(&quot;SELECT `Customer ID` AS ID, COUNT(*) AS number_of_visits FROM visite GROUP BY `Customer ID`&quot;).show()
+---+----------------+                                                          
| ID|number_of_visits|
+---+----------------+
| 12|               1|
|  1|               1|
| 13|               1|
|  6|               1|
| 16|               1|
|  3|               1|
| 20|               1|
|  5|               1|
| 19|               1|
| 15|               1|
|  9|               1|
| 17|               1|
|  4|               1|
|  8|               1|
|  7|               1|
| 10|               1|
| 11|               1|
| 14|               1|
|  2|               1|
| 18|               1|
+---+----------------+</code></pre></details></li></ul><ul id="76e0f8e4-1303-4c0a-a54f-ed74618a7bf8" class="toggle"><li><details open=""><summary>7.5) Store the results of the above dataframe as a parquet table.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ee05a1b1-f639-4cf9-a0b3-fcbc224e841f" class="code code-wrap"><code class="language-Scala">// Alias the column in the SQL query
val resultDF = sql(&quot;SELECT `Customer ID` AS ID, COUNT(*) AS number_of_visits FROM visite GROUP BY `Customer ID`&quot;)

// Save the dataframe as a Parquet table
resultDF.write.parquet(&quot;/spark/visits_parquet_table&quot;)</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1a722a8d-850f-430f-844d-713dc27e3cce" class="code code-wrap"><code class="language-Scala">scala&gt; val resultDF = sql(&quot;SELECT `Customer ID` AS ID, COUNT(*) AS number_of_visits FROM visite GROUP BY `Customer ID`&quot;)
resultDF: org.apache.spark.sql.DataFrame = [ID: int, number_of_visits: bigint]

scala&gt; 

scala&gt; // Save the dataframe as a Parquet table

scala&gt; resultDF.write.parquet(&quot;/spark/visits_parquet_table&quot;)</code></pre><p id="18f409b7-9066-4370-81b3-52adc9fa0882" class="">checking the <code><strong>/spark/</strong></code><strong> </strong>in <code>hdfs</code> file system to check if any parquet table is  created</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="599a336d-36eb-4ccb-960d-002d9422cea0" class="code code-wrap"><code class="language-Scala">dexter@dexter-VirtualBox:~$ hadoop fs -ls /spark/visits_parquet_table
23/12/21 11:29:34 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Found 20 items
-rw-r--r--   1 dexter supergroup          0 2023-12-21 11:26 /spark/visits_parquet_table/_SUCCESS
-rw-r--r--   1 dexter supergroup        365 2023-12-21 11:26 /spark/visits_parquet_table/part-00000-18b7d11e-bd51-4c89-943b-20b6e9dc3c84-c000.snappy.parquet
-rw-r--r--   1 dexter supergroup        660 2023-12-21 11:26 /spark/visits_parquet_table/part-00024-18b7d11e-bd51-4c89-943b-20b6e9dc3c84-c000.snappy.parquet
-rw-r--r--   1 dexter supergroup        660 2023-12-21 11:26 /spark/visits_parquet_table/part-00043-18b7d11e-bd51-4c89-943b-20b6e9dc3c84-c000.snappy.parquet
-rw-r--r--   1 dexter supergroup        660 2023-12-21 11:26 /spark/visits_parquet_table/part-00048-18b7d11e-bd51-4c89-943b-20b6e9dc3c84-c000.snappy.parquet
-rw-r--r--   1 dexter supergroup        690 2023-12-21 11:26 /spark/visits_parquet_table/part-00049-18b7d11e-bd51-4c89-943b-20b6e9dc3c84-c000.snappy.parquet
-rw-r--r--   1 dexter supergroup        660 2023-12-21 11:26 /spark/visits_parquet_table/part-00051-18b7d11e-bd51-4c89-943b-20b6e9dc3c84-c000.snappy.parquet
-rw-r--r--   1 dexter supergroup        660 2023-12-21 11:26 /spark/visits_parquet_table/part-00053-18b7d11e-bd51-4c89-943b-20b6e9dc3c84-c000.snappy.parquet
-rw-r--r--   1 dexter supergroup        660 2023-12-21 11:26 /spark/visits_parquet_table/part-00066-18b7d11e-bd51-4c89-943b-20b6e9dc3c84-c000.snappy.parquet
-rw-r--r--   1 dexter supergroup        660 2023-12-21 11:26 /spark/visits_parquet_table/part-00069-18b7d11e-bd51-4c89-943b-20b6e9dc3c84-c000.snappy.parquet
-rw-r--r--   1 dexter supergroup        660 2023-12-21 11:26 /spark/visits_parquet_table/part-00077-18b7d11e-bd51-4c89-943b-20b6e9dc3c84-c000.snappy.parquet
-rw-r--r--   1 dexter supergroup        690 2023-12-21 11:26 /spark/visits_parquet_table/part-00089-18b7d11e-bd51-4c89-943b-20b6e9dc3c84-c000.snappy.parquet
-rw-r--r--   1 dexter supergroup        660 2023-12-21 11:26 /spark/visits_parquet_table/part-00102-18b7d11e-bd51-4c89-943b-20b6e9dc3c84-c000.snappy.parquet
-rw-r--r--   1 dexter supergroup        660 2023-12-21 11:26 /spark/visits_parquet_table/part-00103-18b7d11e-bd51-4c89-943b-20b6e9dc3c84-c000.snappy.parquet
-rw-r--r--   1 dexter supergroup        660 2023-12-21 11:26 /spark/visits_parquet_table/part-00107-18b7d11e-bd51-4c89-943b-20b6e9dc3c84-c000.snappy.parquet
-rw-r--r--   1 dexter supergroup        660 2023-12-21 11:26 /spark/visits_parquet_table/part-00122-18b7d11e-bd51-4c89-943b-20b6e9dc3c84-c000.snappy.parquet
-rw-r--r--   1 dexter supergroup        660 2023-12-21 11:26 /spark/visits_parquet_table/part-00163-18b7d11e-bd51-4c89-943b-20b6e9dc3c84-c000.snappy.parquet
-rw-r--r--   1 dexter supergroup        660 2023-12-21 11:26 /spark/visits_parquet_table/part-00168-18b7d11e-bd51-4c89-943b-20b6e9dc3c84-c000.snappy.parquet
-rw-r--r--   1 dexter supergroup        660 2023-12-21 11:26 /spark/visits_parquet_table/part-00174-18b7d11e-bd51-4c89-943b-20b6e9dc3c84-c000.snappy.parquet
-rw-r--r--   1 dexter supergroup        660 2023-12-21 11:26 /spark/visits_parquet_table/part-00192-18b7d11e-bd51-4c89-943b-20b6e9dc3c84-c000.snappy.parquet</code></pre><p id="b5ffbc27-18cc-4c3b-a686-0c9a8e57aeac" class="">
</p></details></li></ul><ul id="b05cee07-01b7-4c6e-baf9-fe817f40a70c" class="toggle"><li><details open=""><summary>7.6) Modify query in 7.4 to order the results in descending order of the count.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="098a2fed-18b3-40a0-a5f3-5c4b4d826726" class="code code-wrap"><code class="language-Scala">val dfs=spark.read.option(&quot;header&quot;,&quot;true&quot;).option(&quot;inferSchema&quot;,&quot;true&quot;).csv(&quot;/spark/hospitalData.csv&quot;)
dfs.createOrReplaceTempView(&quot;visite&quot;)
sql(&quot;SELECT `Customer ID` AS ID, COUNT(*) AS number_of_visits FROM visite GROUP BY `Customer ID` ORDER BY number_of_visits DESC&quot;).show</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="48290762-3a32-42fc-b8f9-e132efb4aa2e" class="code code-wrap"><code class="language-Scala">scala&gt; sql(&quot;SELECT `Customer ID` AS ID, COUNT(*) AS number_of_visits FROM visite GROUP BY `Customer ID` ORDER BY number_of_visits DESC&quot;).show
+---+----------------+                                                          
| ID|number_of_visits|
+---+----------------+
|  1|               1|
| 13|               1|
| 12|               1|
|  6|               1|
| 16|               1|
|  3|               1|
| 20|               1|
| 19|               1|
|  5|               1|
| 15|               1|
|  9|               1|
| 17|               1|
|  8|               1|
|  4|               1|
| 10|               1|
|  7|               1|
| 11|               1|
| 14|               1|
| 18|               1|
|  2|               1|
+---+----------------+</code></pre></details></li></ul><ul id="43ed34c8-24bd-4a18-8e96-ba698a1e6a33" class="toggle"><li><details open=""><summary>7.7) Write a method that takes hospital records dataframe and a number and returns the top n number of symptoms. You have done similar mapreduce job in section 4.8.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ee5b270b-9e4e-40d2-b291-1ee5ecf71a08" class="code code-wrap"><code class="language-Scala">import org.apache.spark.sql.{DataFrame, Row}
import org.apache.spark.sql.functions.desc

def topsymptoms(hospitalRecords: DataFrame, n: Int): Array[Row] = {
  val symptomCounts = hospitalRecords.groupBy(&quot;Symptoms&quot;).count().sort(desc(&quot;count&quot;))
  val topSymptoms = symptomCounts.take(n)
  topSymptoms
}

// Assuming &quot;dfs&quot; is your DataFrame
val topSymptomsArray = topsymptoms(dfs, 3)
topSymptomsArray.foreach(println)</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="4e17191a-a862-4b5c-a261-651ef594eb9f" class="code code-wrap"><code class="language-Scala">scala&gt; import org.apache.spark.sql.{DataFrame, Row}
import org.apache.spark.sql.{DataFrame, Row}

scala&gt; import org.apache.spark.sql.functions.desc
import org.apache.spark.sql.functions.desc

scala&gt; 

scala&gt; def topsymptoms(hospitalRecords: DataFrame, n: Int): Array[Row] = {
     |   val symptomCounts = hospitalRecords.groupBy(&quot;Symptoms&quot;).count().sort(desc(&quot;count&quot;))
     |   val topSymptoms = symptomCounts.take(n)
     |   topSymptoms
     | }
topsymptoms: (hospitalRecords: org.apache.spark.sql.DataFrame, n: Int)Array[org.apache.spark.sql.Row]

scala&gt; 

scala&gt; // Assuming &quot;dfs&quot; is your DataFrame

scala&gt; val topSymptomsArray = topsymptoms(dfs, 3)
topSymptomsArray: Array[org.apache.spark.sql.Row] = Array([Sore Throat:Fever:Fatigue,2], [Fever:Headache:Cough,2], [Headache:Cough:Cold,2])

scala&gt; topSymptomsArray.foreach(println)
[Sore Throat:Fever:Fatigue,2]
[Fever:Headache:Cough,2]
[Headache:Cough:Cold,2]

scala&gt;</code></pre></details></li></ul><ul id="471bd7e4-4261-494e-9152-23e2fb44bd51" class="toggle"><li><details open=""><summary>7.8) Use window operations on the hospital record dataframe to add the number previous visits by a patient to each visit record. This will be 0 for the first visit. Then write a query to list the customers who have visited more than once. Check the sql plan for this query in the web-interface.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="b852db54-44a1-4e7c-ac14-5dd1eae70167" class="code code-wrap"><code class="language-Scala">import org.apache.spark.sql.expressions.Window
import org.apache.spark.sql.functions._

val wspec = Window.partitionBy(&quot;Customer ID&quot;).orderBy(&quot;Visit Date&quot;)
val visitsWithPrevious = dfs.withColumn(&quot;PreviousVisits&quot;, row_number().over(wspec) - 1)

val multipleVisits = visitsWithPrevious.groupBy(&quot;Customer ID&quot;).agg(count(&quot;*&quot;).alias(&quot;TotalVisits&quot;)).where(col(&quot;TotalVisits&quot;) &gt; 1).select(&quot;Customer ID&quot;).distinct()
multipleVisits.show()
multipleVisits.explain()</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="0a175d76-5132-4185-a08a-41045f316f67" class="code code-wrap"><code class="language-Scala">scala&gt; import org.apache.spark.sql.expressions.Window
import org.apache.spark.sql.expressions.Window

scala&gt; import org.apache.spark.sql.functions._
import org.apache.spark.sql.functions._

scala&gt; 

scala&gt; val wspec = Window.partitionBy(&quot;Customer ID&quot;).orderBy(&quot;Visit Date&quot;)
wspec: org.apache.spark.sql.expressions.WindowSpec = org.apache.spark.sql.expressions.WindowSpec@7c0e06c7

scala&gt; val visitsWithPrevious = dfs.withColumn(&quot;PreviousVisits&quot;, row_number().over(wspec) - 1)
visitsWithPrevious: org.apache.spark.sql.DataFrame = [Customer ID: int, Visit Date: timestamp ... 2 more fields]

scala&gt; 

scala&gt; val multipleVisits = visitsWithPrevious.groupBy(&quot;Customer ID&quot;).agg(count(&quot;*&quot;).alias(&quot;TotalVisits&quot;)).where(col(&quot;TotalVisits&quot;) &gt; 1).select(&quot;Customer ID&quot;).distinct()
multipleVisits: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [Customer ID: int]

scala&gt; multipleVisits.show()
+-----------+
|Customer ID|
+-----------+
+-----------+


scala&gt; multipleVisits.explain()
== Physical Plan ==
*(2) HashAggregate(keys=[Customer ID#213], functions=[])
+- *(2) HashAggregate(keys=[Customer ID#213], functions=[])
   +- *(2) Project [Customer ID#213]
      +- *(2) Filter (TotalVisits#261L &gt; 1)
         +- *(2) HashAggregate(keys=[Customer ID#213], functions=[count(1)])
            +- Exchange hashpartitioning(Customer ID#213, 200)
               +- *(1) HashAggregate(keys=[Customer ID#213], functions=[partial_count(1)])
                  +- *(1) FileScan csv [Customer ID#213] Batched: false, Format: CSV, Location: InMemoryFileIndex[hdfs://localhost:9000/spark/hospitalData.csv], PartitionFilters: [], PushedFilters: [], ReadSchema: struct&lt;Customer ID:int&gt;</code></pre></details></li></ul><ul id="15fec63f-8430-4721-b000-9308a449f63a" class="toggle"><li><details open=""><summary>7.9) Modify the parameters maxPartitionBytes and shuffle.partitions to smaller values and check the query respons for queries in 7.8</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="7448beda-ef54-4e15-9e8c-8c1dab41115b" class="code code-wrap"><code class="language-Scala">// Set the maxPartitionBytes configuration
spark.conf.set(&quot;spark.sql.files.maxPartitionBytes&quot;, (64 * 1024 * 1024).toString) // 64 megabytes in bytes
// Set the shuffle partitions configuration
spark.conf.set(&quot;spark.sql.shuffle.partitions&quot;, &quot;4&quot;)</code></pre></details></li></ul><ul id="cbed98f8-22ac-437e-9aab-41eb948d49b5" class="toggle"><li><details open=""><summary>7.10) Create a case class for the purchase record read in 7.3 and convert the dataframe to a dataset. Filter the records with price &gt; 100.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="5129c596-a509-4454-ba61-ca9ab445b4d3" class="code code-wrap"><code class="language-Scala">case class PurchaseRecord(ProductName: String, PurchasePrice: Int, PurchaseDate: String)
// Read the CSV file into a DataFrame
val df1 = spark.read.option(&quot;header&quot;, &quot;true&quot;).option(&quot;inferSchema&quot;, &quot;true&quot;).csv(&quot;/spark/purchaseData.csv&quot;)
// Create a new PurchaseRecord
val df2 = PurchaseRecord(&quot;tabsil taws&quot;, 200, &quot;2023-12-30&quot;)
// Convert the PurchaseRecord to a Dataset
val dsnew = Seq(df2).toDS
// Show the contents of the Dataset
dsnew.show
// Filter the Dataset based on the PurchasePrice
val filter = dsnew.filter(record =&gt; record.PurchasePrice &gt; 100)
// Show the filtered Dataset
filter.show()</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="cc3989b8-06e8-4ee0-98b4-189457161a56" class="code code-wrap"><code class="language-Scala">scala&gt; dsnew.show
+-----------+-------------+------------+
|ProductName|PurchasePrice|PurchaseDate|
+-----------+-------------+------------+
|tabsil taws|          200|  2023-12-30|
+-----------+-------------+------------+


scala&gt; 

scala&gt; // Filter the Dataset based on the PurchasePrice

scala&gt; val filter = dsnew.filter(record =&gt; record.PurchasePrice &gt; 100)
filter: org.apache.spark.sql.Dataset[PurchaseRecord] = [ProductName: string, PurchasePrice: int ... 1 more field]

scala&gt; 

scala&gt; // Show the filtered Dataset

scala&gt; filter.show()
+-----------+-------------+------------+
|ProductName|PurchasePrice|PurchaseDate|
+-----------+-------------+------------+
|tabsil taws|          200|  2023-12-30|
+-----------+-------------+------------+</code></pre></details></li></ul><ul id="0996112d-542b-4664-82e1-f0474af527ec" class="toggle"><li><details open=""><summary>7.11) Create a case class for the hospital records read in 7.4. Use a map to create another dataset with duplicates removed from list of symptoms.</summary><ul id="e55c931e-8907-4a67-a74d-a3831d3055a7" class="bulleted-list"><li style="list-style-type:disc">it will be better if the header columns in the csv file does not include <strong>spaces </strong>like this <strong>: “</strong>Customer ID<strong>”</strong></li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="54eea17d-d4dc-4454-a36a-b3e0441c0de2" class="code code-wrap"><code class="language-Scala">import org.apache.spark.sql.{Dataset, SparkSession}
// Case class with matching column names
case class HospitalRecord(CustomerID: String, VisitDate: String, Symptoms: String)
val spark = SparkSession.builder.appName(&quot;HospitalRecords&quot;).getOrCreate()
val dfs = spark.read.option(&quot;header&quot;, &quot;true&quot;).csv(&quot;/spark/hospitalData1.csv&quot;)
// Convert DataFrame to Dataset
val hospitalRecordsDS: Dataset[HospitalRecord] = dfs.as[HospitalRecord]
// Define a function to split and remove duplicates
def removeDuplicates(record: HospitalRecord): Seq[String] = {
  record.Symptoms.split(&quot;:&quot;).map(_.trim).distinct
}
// Apply the function and create a Dataset[String]
val uniqueSymptomsDS: Dataset[String] = hospitalRecordsDS.flatMap(record =&gt; removeDuplicates(record))
// Show the unique symptoms
uniqueSymptomsDS.show(false)</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="6525e9bb-7667-4fea-8ac0-f76bf90cc99b" class="code code-wrap"><code class="language-Scala">scala&gt; uniqueSymptomsDS.show(false)
+-----------+
|value      |
+-----------+
|Fever      |
|Headache   |
|Cough      |
|Sore Throat|
|Fever      |
|Fatigue    |
|Headache   |
|Cough      |
|Cold       |
|Fever      |
|Runny Nose |
|Fatigue    |
|Cough      |
|Headache   |
|Sore Throat|
|Runny Nose |
|Fatigue    |
|Headache   |
|Fever      |
|Sore Throat|
+-----------+
only showing top 20 rows</code></pre><p id="1b04598a-f6e4-4b75-809a-2c53b9463369" class="">
</p></details></li></ul><ul id="1a91de0d-03ab-4d3f-aef9-f3ce5ce7f809" class="toggle"><li><details open=""><summary>7.12) create tables in hive from purchase record (PurchaseRecords) and hospital record (HospitalRecords) data frames</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1c7f78cc-0f2f-4f41-a994-1010d81bbd34" class="code code-wrap"><code class="language-Scala">// Read purchase data and create a DataFrame
val dfs = spark.read.option(&quot;header&quot;, &quot;true&quot;).option(&quot;inferSchema&quot;, &quot;true&quot;).csv(&quot;/spark/purchaseData.csv&quot;)
dfs.createOrReplaceTempView(&quot;PurchaseRecords&quot;)
// Create a table for purchase data
spark.sql(&quot;CREATE TABLE IF NOT EXISTS PurchaseRecordsTable AS SELECT * FROM PurchaseRecords&quot;)
// Read hospital data and create a DataFrame
val dfsHospital = spark.read.option(&quot;header&quot;, &quot;true&quot;).option(&quot;inferSchema&quot;, &quot;true&quot;).csv(&quot;/spark/hospitalData.csv&quot;)
dfsHospital.createOrReplaceTempView(&quot;HospitalRecords&quot;)
// Create a table for hospital data
spark.sql(&quot;CREATE TABLE IF NOT EXISTS HospitalRecordsTable AS SELECT * FROM HospitalRecords&quot;)
spark.sql(&quot;show tables&quot;).show</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="0746a558-edee-43ae-a822-cdd634154c22" class="code code-wrap"><code class="language-Scala">scala&gt; spark.sql(&quot;show tables&quot;).show
+--------+--------------------+-----------+
|database|           tableName|isTemporary|
+--------+--------------------+-----------+
| default|hospitalrecordstable|      false|
| default|purchaserecordstable|      false|
| default|        sample_table|      false|
|        |     hospitalrecords|       true|
|        |     purchaserecords|       true|
+--------+--------------------+-----------+</code></pre></details></li></ul><ul id="e01973e7-cb78-49dc-bf39-ddd85c067278" class="toggle"><li><details open=""><summary>7.13) Create an UDF that removes the duplicates from colon separated symptoms string. Use this UDF in a sql query on HospitalRecords table.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ec1aa218-e083-4d02-9421-21b9cbab61e8" class="code code-wrap"><code class="language-Scala">val dfs= spark.read.option(&quot;header&quot;, &quot;true&quot;).option(&quot;inferSchema&quot;, &quot;true&quot;).csv(&quot;/spark/hospitalData.csv&quot;)
dfs.createOrReplaceTempView(&quot;HospitalRecords&quot;) 
import org.apache.spark.sql.functions.udf
val removeDuplicatesUDF = udf((symptom: String) =&gt; {
  symptom.split(&quot;:&quot;).distinct.mkString(&quot;:&quot;)
})
spark.udf.register(&quot;removeDuplicates&quot;, removeDuplicatesUDF)
val query = &quot;SELECT *, removeDuplicates(symptom) AS UniqueSymptoms FROM HospitalRecords&quot;
val result = spark.sql(query)
result.show()</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="6d92a003-5c59-48ee-8fa0-d6d84ded1324" class="code code-wrap"><code class="language-Scala">scala&gt; result.show(false)
+-----------+----------+----------------------------+----------------------------+
|Customer ID|Visit Date|Symptoms                    |UniqueSymptoms              |
+-----------+----------+----------------------------+----------------------------+
|1          |2023-01-15|Fever:Headache:Cough        |Fever:Headache:Cough        |
|2          |2023-02-28|Sore Throat:Fever:Fatigue   |Sore Throat:Fever:Fatigue   |
|3          |2023-03-10|Headache:Cough:Cold         |Headache:Cough:Cold         |
|4          |2023-04-05|Fever:Runny Nose:Fatigue    |Fever:Runny Nose:Fatigue    |
|5          |2023-05-20|Cough:Headache:Sore Throat  |Cough:Headache:Sore Throat  |
|6          |2023-06-08|Runny Nose:Fatigue:Headache |Runny Nose:Fatigue:Headache |
|7          |2023-07-17|Fever:Sore Throat:Cough     |Fever:Sore Throat:Cough     |
|8          |2023-08-22|Headache:Fever:Fatigue      |Headache:Fever:Fatigue      |
|9          |2023-09-30|Cold:Runny Nose:Cough       |Cold:Runny Nose:Cough       |
|10         |2023-10-12|Sore Throat:Fever:Fatigue   |Sore Throat:Fever:Fatigue   |
|11         |2023-11-25|Fever:Headache:Cough        |Fever:Headache:Cough        |
|12         |2023-12-03|Runny Nose:Headache:Fatigue |Runny Nose:Headache:Fatigue |
|13         |2024-01-08|Fever:Runny Nose:Sore Throat|Fever:Runny Nose:Sore Throat|
|14         |2024-02-14|Headache:Cough:Cold         |Headache:Cough:Cold         |
|15         |2024-03-19|Fatigue:Fever:Runny Nose    |Fatigue:Fever:Runny Nose    |
|16         |2024-04-22|Sore Throat:Headache:Fatigue|Sore Throat:Headache:Fatigue|
|17         |2024-05-30|Fever:Runny Nose:Headache   |Fever:Runny Nose:Headache   |
|18         |2024-06-05|Cough:Headache:Fatigue      |Cough:Headache:Fatigue      |
|19         |2024-07-18|Fever:Sore Throat:Runny Nose|Fever:Sore Throat:Runny Nose|
|20         |2024-08-25|Headache:Cough:Fatigue      |Headache:Cough:Fatigue      |
+-----------+----------+----------------------------+----------------------------+</code></pre></details></li></ul><ul id="5b9a18ec-7d92-4d17-80c5-f784b5955d73" class="toggle"><li><details open=""><summary>7.14) Write an sql query on PurchaseRecord table that shows maximum purchase price for each product.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="63dd0602-7967-43a3-af3f-c2724638f302" class="code code-wrap"><code class="language-Scala">val dfs= spark.read.option(&quot;header&quot;, &quot;true&quot;).option(&quot;inferSchema&quot;, &quot;true&quot;).csv(&quot;/spark/purchaseData.csv&quot;)
dfs.createOrReplaceTempView(&quot;PurchaseRecords&quot;) 
val result = spark.sql(&quot;SELECT ProductName, MAX(PurchasePrice) AS MaxPurchasePrice FROM PurchaseRecords GROUP BY ProductName&quot;)
result.show()</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="dec3b6ab-f1e3-4e7b-98ba-69344b1ec5a2" class="code code-wrap"><code class="language-Scala">scala&gt; result.show()
+-----------+----------------+                                                  
|ProductName|MaxPurchasePrice|
+-----------+----------------+
|   ProductL|             130|
|   ProductK|             110|
|   ProductJ|             150|
|   ProductN|             120|
|   ProductS|              95|
|   ProductI|              80|
|   ProductG|              95|
|   ProductQ|             110|
|   ProductB|              80|
|   ProductO|              80|
|   ProductC|             150|
|   ProductM|              95|
|   ProductH|             120|
|   ProductD|              90|
|   ProductT|             120|
|   ProductE|             110|
|   ProductF|             130|
|   ProductP|             150|
|   ProductA|             120|
|   ProductR|             130|
+-----------+----------------+</code></pre></details></li></ul><ul id="83f6fa35-7d37-4e37-855c-7ea86fc17f0e" class="toggle"><li><details open=""><summary>7.15) Create a map that gives a list of illnesses for each symptom. For example &quot;fever&quot;-&gt;&quot;Flu&quot;, &quot;runny nose&quot;-&gt;&quot;cold&quot;. Use this map to write an UDF that takes a colon separated list of symptoms and suggests an illness as diagnosis. Use this udf with the hospital records to add a first diagnosis illness to each record. Remember to use broadcast variables and serialize the class.</summary><p id="ee66e3ca-907a-4482-9af2-c3e6b4ab00a9" class="">
</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="6817ffdc-a155-4cec-89e3-978e6fe0c0ef" class="code code-wrap"><code class="language-Scala">import org.apache.spark.sql.SparkSession
import org.apache.spark.sql.functions.udf

// Initialize Spark session
val spark = SparkSession.builder.appName(&quot;DiagnosisApp&quot;).getOrCreate()

// Create a map of symptoms to illnesses
val symptomIllnessMap = Map(&quot;fever&quot; -&gt; &quot;Flu&quot;, &quot;runny nose&quot; -&gt; &quot;Cold&quot;)

// Broadcast the map for better performance
val broadcastedSymptomIllnessMap = spark.sparkContext.broadcast(symptomIllnessMap)

// Define the UDF using the broadcasted map
val diagnosisUDF = udf((symptoms: String) =&gt; {
  val mapping = broadcastedSymptomIllnessMap.value
  val symptomsList = symptoms.split(&quot;:&quot;)
  val illnesses = symptomsList.flatMap(symptom =&gt; mapping.get(symptom.toLowerCase))
  if (illnesses.nonEmpty) illnesses.head
  else &quot;Unknown&quot;
})

// Assuming the column is named &quot;Symptoms&quot; in your DataFrame
val dfs = spark.read.option(&quot;header&quot;, &quot;true&quot;).option(&quot;inferSchema&quot;, &quot;true&quot;).csv(&quot;/spark/hospitalData1.csv&quot;)
dfs.createOrReplaceTempView(&quot;HospitalRecords&quot;)

// Apply the UDF and create a new DataFrame with the Diagnosis column
val recordsdfs = dfs.withColumn(&quot;Diagnosis&quot;, diagnosisUDF($&quot;Symptoms&quot;))

// Show the resulting DataFrame
recordsdfs.show(false)

// Stop Spark session
spark.stop()</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2f417475-4717-47c4-b8a0-a48f5e95bb59" class="code code-wrap"><code class="language-Scala">scala&gt; recordsdfs.show(false)
+----------+-------------------+----------------------------+---------+
|CustomerID|VisitDate          |Symptoms                    |Diagnosis|
+----------+-------------------+----------------------------+---------+
|1         |2023-01-15 00:00:00|Fever:Headache:Cough        |Flu      |
|2         |2023-02-28 00:00:00|Sore Throat:Fever:Fatigue   |Flu      |
|3         |2023-03-10 00:00:00|Headache:Cough:Cold         |Unknown  |
|4         |2023-04-05 00:00:00|Fever:Runny Nose:Fatigue    |Flu      |
|5         |2023-05-20 00:00:00|Cough:Headache:Sore Throat  |Unknown  |
|6         |2023-06-08 00:00:00|Runny Nose:Fatigue:Headache |Cold     |
|7         |2023-07-17 00:00:00|Fever:Sore Throat:Cough     |Flu      |
|8         |2023-08-22 00:00:00|Headache:Fever:Fatigue      |Flu      |
|9         |2023-09-30 00:00:00|Cold:Runny Nose:Cough       |Cold     |
|10        |2023-10-12 00:00:00|Sore Throat:Fever:Fatigue   |Flu      |
|11        |2023-11-25 00:00:00|Fever:Headache:Cough        |Flu      |
|12        |2023-12-03 00:00:00|Runny Nose:Headache:Fatigue |Cold     |
|13        |2024-01-08 00:00:00|Fever:Runny Nose:Sore Throat|Flu      |
|14        |2024-02-14 00:00:00|Headache:Cough:Cold         |Unknown  |
|15        |2024-03-19 00:00:00|Fatigue:Fever:Runny Nose    |Flu      |
|16        |2024-04-22 00:00:00|Sore Throat:Headache:Fatigue|Unknown  |
|17        |2024-05-30 00:00:00|Fever:Runny Nose:Headache   |Flu      |
|18        |2024-06-05 00:00:00|Cough:Headache:Fatigue      |Unknown  |
|19        |2024-07-18 00:00:00|Fever:Sore Throat:Runny Nose|Flu      |
|20        |2024-08-25 00:00:00|Headache:Cough:Fatigue      |Unknown  |
+----------+-------------------+----------------------------+---------+</code></pre></details></li></ul></details></li></ul></div></details></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>